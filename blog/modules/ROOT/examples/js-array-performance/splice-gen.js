const process = require('process')
const Benchmark = require('benchmark')

if (process.env.PROTOTYPE_TAMPERING) {
  Object.setPrototypeOf(Array.prototype, {})
}

// tag::splice-gen-function[]
function spliceGen (list, start, deleteCount) {
  if (deleteCount <= 0) {
    return
  }
  const length = list.length
  /*
  if (start === 0 && deleteCount >= length) {
    list.length = 0
  }
   */
  for (var i = start, k = i + deleteCount, n = length; k < n; i += 1, k += 1)
    list[i] = list[k]

  list.length = i
  //for (;i < length; i++)
  //  list.pop()
}

// end::splice-gen-function[]

/*
const arr1 = [
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
]
spliceGen(arr1, 0, 100)
console.log(arr1)

const arr2 = [
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '99', '100',
]
spliceGen(arr2, 0, 99)
console.log(arr2)

const arr3 = [
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '99', '100',
]
spliceGen(arr3, 1, 98)
console.log(arr3)

const arr4 = [
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
  '1', '2', '3', '4', '5', '6', '7', '8', '9', '100',
]
spliceGen(arr4, 1, 99)
console.log(arr4)
 */

const suite = new Benchmark.Suite
suite
  .add('spliceGen 100', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
    ], 0, 100)
  })
  .add('spliceGen 99', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
    ], 0, 99)
  })
  .add('spliceGen 10', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'
    ], 0, 10)
  })
  .add('spliceGen 9', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'
    ], 0, 9)
  })
  .add('spliceGen 1', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'
    ], 0, 1)
  })
  .add('spliceGen 100 - del: 1', () => {
    spliceGen([
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
    ], 0, 1)
  })
  .add('Array#splice 100', () => {
    [
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
    ].splice(0, 100)
  })
  .add('Array#splice 99', () => {
    [
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
    ].splice(0, 99)
  })
  .add('Array#splice 10', () => {
    ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'].splice(0, 10)
  })
  .add('Array#splice 9', () => {
    ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'].splice(0, 9)
  })
  .add('Array#splice 1', () => {
    ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'].splice(0, 1)
  })
  .add('Array#splice 100 - del: 1', () => {
    [
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '10',
      '1', '2', '3', '4', '5', '6', '7', '8', '9', '100',
    ].splice(0, 1)
  })
  .on('cycle', function (event) {
    console.log(String(event.target))
  })
  .run({ 'async': true })


/*
const suite = new Benchmark.Suite
suite
  .add('spliceGen', () => {
    spliceGen(['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'], 0, 2)
  })
  .add('Array#splice', () => {
    ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'].splice(0, 2)
  })
  .on('cycle', function (event) {
    console.log(String(event.target))
  })
  .run({ 'async': true })
*/
